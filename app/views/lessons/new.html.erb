<div class="container">
  <div class="row text-center">
    <div class="col-xs-12 col-md-6 col-md-offset-3">
      <h2>Create your lesson</h2>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 col-md-6 col-md-offset-3">
      <%= simple_form_for @lesson do |f| %>
        <%= f.input :name, label: "Title" %>
        <%= f.input :description, as: :text %>
        <%= f.input :category, collection: Lesson::CATEGORIES %>
        <%= f.input :duration, collection: Lesson::DURATION, label: "Duration in hours" %>
        <%= f.input :level, collection: Lesson::LEVELS %>

            <div class='datepicker' >
              <div id="datepicker_id"></div>
            </div>

        <%= f.input :dates, as: :hidden %>

        <%= f.input :address %>
        <%= f.input :city %>
        <%= f.button :submit %>
      <% end %>
      <%= link_to "Back to the lessons", lessons_path %>
    </div>
  </div>
</div>


<% content_for(:js) do %>
  <%= javascript_tag do %>
    $('document').ready(function(){
      $('.datepicker div').datepicker({
        format: "mm/dd/yyyy",
        clearBtn: true,
        multidate: true,
        todayHighlight: true,
        startDate: "<%= DateTime.now.strftime('%m/%d/%Y') %>",
      });
      $('.table-condensed').on('mouseleave', function(event) {
        var dates = $('#datepicker_id').datepicker('getDates');
        var dates_format = []

        dates.forEach(function(date_string) {
          var date = new Date(date_string);
          var date_format = $.datepicker.formatDate('mm/dd/yy', date);
          dates_format.push("\"" + date_format + "\"")
        });
        $('#lesson_dates').val('['+dates_format+']')
      });
    });
  <% end %>
<% end %>
